

<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
  <title>搭配詞大全</title>
  <style>
    :root {
      --bg: #121212;
      --card: #1e1e1e;
      --border: #333;
      --text: #e0e0e0;
      --muted: #a0a0a0;
      --accent: #cfb53b;
      --radius: 8px;
      --maxw: 1100px;
      
      /* 同步 kw130 字級：緊湊型工具書比例 */
      --h1: 2.5rem;
      --cardTitle: 1.4rem;
      --body: 0.95rem;
      --small: 0.85rem;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    body {
      margin: 0;
      /* 同步 kw130 字體順序：移除手動字距，讓 Meiryo 原生緊湊感發揮 */
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Microsoft JhengHei", "Meiryo", sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      letter-spacing: 0;
      -webkit-font-smoothing: antialiased;
    }

    .wrap { max-width: var(--maxw); margin: 0 auto; padding: 16px; }
    header { text-align: center; padding: 8px 0; }
    h1 { margin: 0; font-size: var(--h1); color: var(--accent); letter-spacing: -0.01em; }

    /* 手機版優化：控制列排版 */
    .controls { margin: 15px 0; display: flex; flex-direction: column; gap: 8px; }
    .input {
      width: 100%; background: var(--card); border: 1px solid var(--border);
      color: var(--text); border-radius: 6px; padding: 10px 12px;
      font-size: 0.95rem; outline: none; transition: border-color 0.2s;
    }
    .select-group { display: flex; gap: 8px; }
    .select {
      flex: 1; background: var(--card); border: 1px solid var(--border);
      color: var(--text); border-radius: 6px; padding: 8px 10px;
      font-size: 0.85rem; cursor: pointer; outline: none; min-width: 0;
    }
    .input:focus, .select:focus { border-color: var(--accent); }

    /* 資訊條優化：水平滑動不換行 */
    .chips {
      display: flex; gap: 6px; overflow-x: auto; padding-bottom: 8px;
      margin-bottom: 10px; scrollbar-width: none;
    }
    .chips::-webkit-scrollbar { display: none; }
    .chip {
      white-space: nowrap; background: #252525; border: 1px solid var(--border);
      padding: 3px 10px; border-radius: 4px; font-size: 0.72rem; color: var(--muted);
    }
    .chip strong { color: var(--accent); }

    /* 卡片設計 */
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px; }
    @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }

    .card {
      background: var(--card); border: 1px solid var(--border); border-radius: var(--radius);
      padding: 14px; transition: transform 0.15s ease;
    }
    .cardHead { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    
    .term {
      font-size: var(--cardTitle); 
      font-weight: 600; /* 同步 kw130 字重 */
      color: var(--accent);
      margin: 0;
      letter-spacing: 0; /* 微調標題字距，讓日文更紮實 */
      line-height: 1.2;
    }
    
    .reading {
  display: block;          /* ← 關鍵：強制換行 */
  margin-top: 2px;

  font-size: 12px;       /* ← 跟 kw130 接近 */
  color: #9aa0a6;          /* 灰階輔助資訊色 */
  font-weight: 400;
  letter-spacing: 0.04em;
}
.tags { display: flex; flex-direction: column; align-items: flex-end; gap: 4px; }
    .tag { font-size: 0.65rem; color: var(--muted); border: 1px solid var(--border); padding: 1px 6px; border-radius: 4px; }

    .sec { margin-top: 10px; }
    
    /* 回歸的小色塊裝飾 */
    .secTitle {
      font-size: 0.72rem; font-weight: 700; color: var(--muted);
      margin-bottom: 6px; display: flex; align-items: center; gap: 6px;
      text-transform: uppercase;
    }
    .secTitle::before {
      content: ""; width: 3px; height: 11px; background: var(--accent);
      border-radius: 1px; display: inline-block;
    }

    .meaning { margin: 0 0 0 2px; font-size: var(--body); line-height: 1.5; color: #ddd; }
    
    /* 例文色塊優化 */
    .example {
      margin: 4px 0 0; padding: 10px 12px; background: #262626;
      border-radius: 6px; font-size: var(--body); font-weight: 400;      
      color: #ccc; line-height: 1.6; 
/*      
border-left: 3px solid #444;
      */
      white-space: pre-wrap;
      font-style: italic;
    }

    .empty { text-align: center; padding: 40px; color: var(--muted); font-size: var(--body); }
    .muted-text { font-size: 0.75rem; color: #555; padding-left: 2px; }
  </style>
</head>
<body>
  <div class="wrap">
    <header><h1 id="pageTitle">Loading...</h1></header>

    <div class="controls">
      <input id="q" class="input" placeholder="搜尋：日文 / 意義 / 例句" />
      <div class="select-group">
        <select id="cat" class="select"></select>
        <select id="type" class="select"></select>
      </div>
    </div>

    <div class="chips" id="chips"></div>
    <div class="grid" id="grid"></div>
    <div id="empty" class="empty" style="display:none;">找不到符合條件的條目</div>
  </div>

  <script>
    // --- 資料區：請將您的資料貼回此處 ---
    const RAW_DATA = `
超高頻搭配詞

心智・思考{
目を通す（めをとおす）：過目、瀏覽：この資料、あとで目を通しておくね。這份資料我晚點會先過目一下。
頭に入れる（あたまにいれる）：記住、放進腦袋：今日中に手順を頭に入れておきたい。我想在今天之內把流程記起來。
腑に落ちない（ふにおちない）：無法理解、想不通：説明は分かるけど、なんか腑に落ちない。說明我懂，但總覺得哪裡想不通。
目に焼き付く（めにやきつく）：刻印在眼裡、難以忘懷：あの景色が目に焼き付いて離れない。那個景色刻在我腦海裡揮之不去。
耳に残る（みみにのこる）：縈繞在耳邊、聽了難忘：その一言が耳に残って、ずっと気になる。那句話一直在耳邊迴盪，讓我很在意。
ピンとくる（ぴんとくる）：馬上理解、有靈感：それ聞いてピンときた。原因それだ。聽你一說我就有感覺了，原因就是那個。
見当がつく（けんとうがつく）：大致推測、心裡有數：だいたい見当がつく。たぶん設定の問題だよ。我大概有數了，應該是設定的問題。
見当違い（けんとうちがい）：離題、完全搞錯：それは見当違いかも。方向が違う気がする。那可能是搞錯方向了，我覺得路線不對。
気に留める（きにとめる）：放在心上、留意：その点は気に留めておく。あとで確認するね。那點我會記著，晚點再確認。
気に留めない（きにとめない）：不放在心上、不在意：細かいことは気に留めないで。大丈夫。小事別放在心上，沒問題。
心に響く（こころにひびく）：觸動人心、打動心弦：その言葉、心に響いた。助かったよ。那句話很打動我，真的幫到我了。
胸に刻む（むねにきざむ）：銘記在心：言われたことを胸に刻んで、次に活かす。我會把你說的話記在心裡，下次改進。
先が読める（さきがよめる）：看得出後勢、看得見前景：この流れだと、先が読めるね。もう少しで終わる。照這個走向，我大概看得出來了，快結束了。
先が見えない（さきがみえない）：前景不明、看不見未來：今の状況だと、先が見えなくて不安。以現在狀況來看，看不到後續有點不安。
}
態度・情緒{
気が重い（きがおもい）：覺得沈重、提不起勁：行かなきゃだけど、気が重いな…。雖然得去，但心情很沉重…。
気が楽だ（きがらくだ）：輕鬆、無壓力：話せて気が楽になった。ありがとう。聊完心裡輕鬆多了，謝謝。
気が利く（きがきく）：機靈周到、貼心：それ用意してくれるの、気が利くね。你連那個都先準備好，真貼心。
気が回る（きがまわる）：想得周全、細膩：そこまで気が回るのすごい。助かった。你連那種細節都想到，太強了，幫大忙。
気が短い（きがみじかい）：急性子、沒耐性：自分でも気が短いって分かってる。我自己也知道我很沒耐性。
気が長い（きがながい）：有耐性、慢性子：待てるのは気が長い人だよね。能等的人真的很有耐心。
気が散る（きがちる）：心不在焉、分心：通知が多くて、気が散る。通知一直跳出來，超分心。
気を遣う（きをつかう）：顧慮、費心：そんなに気を遣わなくていいよ。你不用那麼費心啦。
気を抜く（きをぬく）：放鬆警戒、鬆懈：ここで気を抜くとミスるからね。這裡一鬆懈就會出錯喔。
気を張る（きをはる）：繃緊神經、打起精神：今日は気を張っていこう。大事な日だ。今天要打起精神，因為很重要。
ムッとする（むっとする）：一肚子氣、悶怒：その言い方はちょっとムッとした。你那種講法我有點不爽。
カチンとくる（かちんとくる）：被激到、火冒三丈：今の一言、さすがにカチンときた。剛那句我真的被激到。
しっくりくる（しっくりくる）：合拍、合適、順心：この表現が一番しっくりくる。這個說法最貼切。
もやもやする（もやもやする）：悶悶不樂、卡卡的：理由は分からないけど、もやもやする。理由說不上來，但就是很悶。
}
人際・社交{
顔を立てる（かおをたてる）：給面子：今日は相手の顔を立てて、こちらは引いたほうがいい。今天先給對方面子，我們這邊退一步比較好。
顔が広い（かおがひろい）：人脈廣、交際廣：あの人、顔が広いから相談してみよう。那個人交際廣，找他問看看吧。
顔を出す（かおをだす）：露個臉、現身一下：時間があれば、会にちょっと顔を出すよ。有時間的話，我會去聚會露個臉。
水を差す（みずをさす）：潑冷水、掃興：盛り上がってるところに水を差すのはやめよう。大家正嗨的時候別潑冷水。
場を読む（ばをよむ）：看場合：まず場を読んでから話そう。先看場合再開口吧。
空気を読む（くうきをよむ）：讀空氣、看氣氛行事：今は空気を読んで、余計なことは言わない。現在就讀空氣，別多說。
話を盛る（はなしをもる）：誇大、加油添醋：それ、ちょっと話を盛ってない？你是不是有點加油添醋？
話をそらす（はなしをそらす）：轉移話題：都合が悪いとすぐ話をそらすよね。你一不方便就立刻轉移話題耶。
話がかみ合う（はなしがかみあう）：談得來、話題接得上：この人とは話がかみ合うから楽だ。跟這個人聊得來，很輕鬆。
話がこじれる（はなしがこじれる）：談崩、越談越糟：ここで言い方を間違えると話がこじれる。這裡講法一錯，事情就會越談越糟。
一言多い（ひとことおおい）：多嘴、多講一句：ごめん、今のは一言多かった。抱歉，剛剛那句我多嘴了。
}
工作・學習{
手を抜く（てをぬく）：偷工減料、敷衍：ここは手を抜くと後で痛い目を見る。這裡偷懶的話，之後會吃苦頭。
手を打つ（てをうつ）：採取對策、出手處理：問題が大きくなる前に手を打とう。在問題變大前先出手處理。
手が回らない（てがまわらない）：顧不到、忙不過來：今週は手が回らないから、来週でいい？這週忙不過來，可以下週再弄嗎？
手が空く（てがあく）：手頭空下來、有空檔：手が空いたら、これも見てくれる？你有空檔的時候，也能幫我看這個嗎？
手を貸す（てをかす）：幫一把、搭把手：ちょっと手を貸して。5分で終わる。幫我一下，五分鐘就好。
手間を食う（てまをくう）：費工、耗工夫：この作業、思ったより手間を食うな。這工作比想像中更費工。
段取りを組む（だんどりをくむ）：做好流程安排、排程：先に段取りを組んでおくと早い。先把流程安排好會比較快。
詰めが甘い（つめがあまい）：收尾不嚴謹、細節鬆散：全体はいいけど、最後の詰めが甘い。整體不錯，但最後收尾不夠嚴謹。
抜け漏れがある（ぬけもれがある）：有遺漏、疏漏：チェックしたけど、まだ抜け漏れがあるかも。我檢查過了，但可能還有遺漏。
すり合わせる（すりあわせる）：互相調整、對齊：要件を一回すり合わせてから進めよう。先把需求對齊一次再往下做。
ボールを持つ（ぼーるをもつ）：（專案）負責跟進：この件は私がボールを持つね。這件事我來負責跟進。
ボールを返す（ぼーるをかえす）：交還責任、回覆：確認したのでボール返します。次お願いします。我確認過了，把球丟回去，下一步麻煩你。
根拠を示す（こんきょをしめす）：提出依據：その判断の根拠を示してもらえる？可以給我那個判斷的依據嗎？
腰を据える（こしをすえる）：沉住氣、專心投入：腰を据えて取り組まないと終わらない。不沉住氣專心做，這件事做不完。
}
生活・比喻{
ツボにはまる（つぼにはまる）：正中要點、對味：その例え、完全にツボにはまった。那個比喻完全打中要點。
コツをつかむ（こつをつかむ）：抓到訣竅：一回コツをつかむと一気に楽になる。一抓到訣竅就會一下子輕鬆很多。
クセが強い（くせがつよい）：個性很強烈：この店、味のクセが強いけどハマる人はハマる。這家店味道個性很強，但會中毒的人就會很愛。
地雷を踏む（じらいをふむ）：踩到地雷：その話題は地雷だから触れないほうがいい。那個話題是地雷，最好別碰。
波に乗る（なみにのる）：乘勢而上：今は波に乗ってるから、このまま進めよう。現在正在順風上，就照這勢頭推進吧。
追い風になる（おいかぜになる）：成為順風：このニュースは追い風になるはず。這個消息應該會成為順風。
逆風を受ける（ぎゃくふうをうける）：處境不利：今は逆風を受けてるけど、耐えよう。現在處境不利，但先撐住。
すき間を狙う（すきまをねらう）：鑽縫隙、找利基：大手と正面から戦わず、すき間を狙おう。別正面硬碰大公司，找利基切入。
話の腰を折る（はなしのこしをおる）：打斷說話：ごめん、話の腰を折っちゃった。続けて。抱歉我打斷你了，你繼續。
骨が折れる（ほねがおれる）：費力、吃力：この作業は骨が折れるけど、やるしかない。這工作很吃力，但只能做。
首が回らない（くびがまわらない）：忙不過來／周轉不靈：今月は支払いが多くて首が回らない。這個月支出太多，周轉不靈。
}
成敗・風險{
先手を打つ（せんてをうつ）：先發制人：トラブルになる前に先手を打っておこう。在變成麻煩之前先發制人。
一手打つ（いってうつ）：採取一步對策：この状況を変えるには、こちらも一手打つ必要がある。要改變現況，我們也得出一招。
一枚上手（いちまいうわて）：技高一籌：相手が一枚上手だった。完敗。對方技高一籌，完全輸了。
裏目に出る（うらめにでる）：適得其反：良かれと思ったのに裏目に出た。明明是為了好，結果適得其反。
火に油を注ぐ（ひにあぶらをそそぐ）：火上加油：そこで反論すると火に油を注ぐだけだよ。你現在反駁只會火上加油。
火消しに走る（ひけしにはしる）：趕緊滅火：炎上しそうだから、早めに火消しに走ったほうがいい。看起來要炎上了，最好趕快去滅火。
取り返しがつかない（とりかえしがつかない）：無法挽回：今ここでミスると取り返しがつかない。現在這裡出錯就無法挽回了。
首を突っ込む（くびをつっこむ）：插手、介入：関係ないなら首を突っ込まないほうがいい。如果沒關係就別插手。
引き際をわきまえる（ひきぎわをわきまえる）：懂得適時收手：勝ち負けより、引き際をわきまえるのが大事。比起輸贏，懂得適時收手更重要。
}
說話・表達{
腹を割って話す（はらをわってはなす）：開誠布公地談：一回、腹を割って話そう。我們乾脆開誠布公談一次吧。
オブラートに包む（おぶらーとにつつむ）：委婉包裝：言い方をオブラートに包んでくれると助かる。你如果能委婉一點講，我會比較好接。
角が立つ（かどがたつ）：引人不快：その言い方だと角が立つよ。你那樣講會刺到人。
的を射る（まとをいる）：命中要點：その指摘は的を射てる。你的指摘很到位。
ニュアンスを汲む（にゅあんすをくむ）：體會語感：言葉そのものより、ニュアンスを汲んでほしい。比起字面，我希望你抓到語氣。
}
情境・反射{
顔をしかめる（かおをしかめる）：皺眉：彼は一瞬、顔をしかめた。他一瞬間皺了眉。
口を挟む（くちをはさむ）：插嘴：話してる途中で口を挟まないで。別在我講到一半插嘴。
首をかしげる（くびをかしげる）：表示疑惑：その説明に、みんな首をかしげてた。大家對那個說明都一臉疑惑。
肩をすくめる（かたをすくめる）：聳肩（無奈）：どうしようもなくて、肩をすくめた。沒辦法了，只能無奈聳肩。
手を焼く（てをやく）：難以應付：この件は本当に手を焼いてる。這件事真的很難搞。
気を回す（きをまわす）：多想、顧慮：そんなに気を回さなくて大丈夫だよ。不用想那麼多，沒事。
気を利かせる（きをきかせる）：機靈配合：ここは気を利かせて、先に動こう。這裡機靈點，我們先動起來。
気を落とす（きをおとす）：灰心：そんなに気を落とさないで。まだいける。別那麼灰心，還有機會。
気が済む（きがすむ）：心裡過得去：それで気が済むなら、そうしていいよ。如果那樣你心裡過得去，就那樣做吧。
腹をくくる（はらをくくる）：下定決心：もう腹をくくった。やるしかない。我已經下定決心了，只能做。
腹が立つ（はらがたつ）：生氣：その態度はさすがに腹が立つ。那種態度我真的會火大。
胸がいっぱい（むねがいっぱい）：感慨滿懷：みんなの言葉で胸がいっぱいになった。大家的話讓我感動到滿滿的。
腰が重い（こしがおもい）：懶得動：やらなきゃと思うけど、腰が重い。知道該做，但就是懶得動。
水に流す（みずにながす）：既往不咎：今回のことは水に流そう。這次的事就算了吧。
根に持つ（ねにもつ）：記恨：そんなの根に持たないでよ。別把那種事記恨啦。
}
思考・表態{
そういう手もある（そういうてもある）：也是個辦法：なるほど、そういう手もあるね。原來如此，也有那一招啊。
それはそれで（それはそれで）：那樣也有那樣的好：それはそれでアリだと思う。那樣我覺得也可以。
一理ある（いちりある）：有道理：言ってることは一理ある。你說的確有道理。
なんとも言えない（なんともいえない）：很難說：良い悪いは、なんとも言えないな。好不好真的很難說。
さすがに…（さすがに…）：再怎麼說也…：さすがにそれは無理だと思う。再怎麼說我覺得那不行。
どちらかと言えば…（どちらかといえば…）：如果要說的話：どちらかと言えば、Aのほうが好き。如果要說的話，我比較喜歡A。
どの口が言う（どのくちがいう）：你也好意思說：どの口が言うの？さっきと言ってること違うよ。你也好意思說？你剛剛講的跟現在不一樣。
そこまでは…（そこまでは…）：也沒到那程度：いや、そこまでは気にしてない。沒有啦，也沒那麼在意。
ありがち（ありがち）：常見的：それ、ありがちなミスだよ。那是很常見的錯誤。
ありえる話（ありえるはなし）：可能發生的事：それはありえる話だね。念のため確認しよう。那確實有可能，以防萬一確認一下。
}
吐槽・婉拒{
それは違う気がする（それはちがうきがする）：我覺得不太對：うーん、それは違う気がする。嗯…我覺得不太對。
その発想はなかった（そのはっそうはなかった）：沒想到這種想法：その発想はなかった。面白いね。沒想到這招，蠻有趣的。
今はちょっと…（いまはちょっと…）：現在不方便：ごめん、今はちょっと…。また今度。抱歉，我現在有點不方便…下次。
さすがに無理（さすがにむり）：再怎麼說也不行：それはさすがに無理。今日は帰る。那真的不行，我今天要回了。
それはさすがに…（それはさすがに…）：那樣有點過分：それはさすがに…。言い過ぎじゃない？那有點過分了吧…你是不是講太重？
どっちでもいい（どっちでもいい）：都可以：私はどっちでもいいよ。任せる。我都可以，你決定。
ほどほどに（ほどほどに）：適可而止：無理しないで、ほどほどにね。別太勉強，適可而止。
空気読んで（くうきよんで）：看氣氛：お願い、空気読んで今はやめて。拜託看氣氛，現在先別。
それは置いといて（それはおいといて）：先擱一邊：それは置いといて、今の優先はこっち。那先放一邊，現在優先的是這個。
}
決策・推進{
腕を上げる（うでをあげる）：提升本事：最近、腕を上げたね。仕上がりが違う。你最近功力提升了，完成度不一樣。
腕を振るう（うでをふるう）：大展身手：ここで腕を振るってもらおう。這裡就讓你大展身手吧。
話を詰める（はなしをつめる）：敲定細節：時間ある？今日中に話を詰めたい。有空嗎？我想今天之內把細節談定。
話を通す（はなしをとおす）：取得同意：先に上に話を通しておくね。我先跟上面打個招呼取得同意。
根回しをする（ねまわしをする）：事前打點：通したいなら、先に根回しをしたほうが早い。想推過的話，先私下打點會比較快。
方向性を合わせる（ほうこうせいをあわせる）：對齊方向：まず方向性を合わせてから細部を決めよう。先把方向對齊，再決定細節。
見通しを立てる（みとおしをたてる）：預估走向：ざっくりでいいから見通しを立てよう。大概就好，先把走向估出來。
見当をつける（けんとうをつける）：抓概略：まずは予算の見当をつけよう。先抓一下預算的大概範圍。
}
品質・感受{
仕上がりがいい（しあがりがいい）：完成度高：今回のは仕上がりがいいね。這次的成品完成度很高。
収まりがいい（おさまりがいい）：貼合得體：この配置だと収まりがいい。這樣排版／擺放很服貼、很得體。
使い勝手がいい（つかいがってがいい）：好用：これ、使い勝手がいいから手放せない。這個很好用，用了就離不開。
もったいない（もったいない）：可惜：捨てるのはもったいないよ。まだ使える。丟掉太可惜了，還能用。
腑に落ちる（ふにおちる）：想通：その説明で腑に落ちた。なるほど。那樣解釋我就想通了，原來如此。
しっくり来ない（しっくりこない）：不太對勁：悪くないけど、なんかしっくり来ない。不差，但總覺得不太對勁。
雰囲気がある（ふんいきがある）：有氛圍：この写真、雰囲気があるね。這張照片很有氛圍。
こだわりがある（こだわりがある）：有講究：細部にこだわりがあるのが分かる。看得出你對細節很講究。
}
進度・狀況{
目処が立つ（めどがたつ）：有眉目：だいぶ目処が立ってきた。あと少し。大致有眉目了，再一下。
手応えがある（てごたえがある）：有效果：今回は手応えがある。いけそう。這次有手感、有成效，感覺行。
先が見える（さきがみえる）：看得見前景：ここまで来ると先が見えるね。到這裡就看得到終點了。
行き当たりばったり（いきあたりばったり）：沒計畫：行き当たりばったりだと、あとで詰むよ。走一步算一步的話，之後會卡死。
空回りする（からまわりする）：白忙：頑張ってるのに空回りしてる感じ。明明很努力，卻有種白忙的感覺。
バタバタしている（ばたばたしている）：忙亂：今日は朝からバタバタしてる。我今天從早上就忙亂到不行。
ぼちぼちやる（ぼちぼちやる）：慢慢來：焦らず、ぼちぼちやろう。別急，慢慢來就好。
詰まり気味（つまりぎみ）：有點卡：処理が詰まり気味だから、一回整理しよう。流程有點卡，先整理一下。
ひと段落つく（ひとだんらくつく）：告一段落：この件、ようやくひと段落ついた。這件事終於告一段落了。
埋まってる（うまってる）：已滿：その時間はもう埋まってる。別の枠にしよう。那個時間已經滿了，換別的時段。
空いてる（あいてる）：有空：明日の午後なら空いてるよ。明天下午我有空。
押してる（おしてる）：延誤：ごめん、ちょっと押してる。10分遅れる。抱歉有點延誤，我會晚10分鐘。
遅れてる（おくれてる）：落後：進捗、少し遅れてる。巻き返す。進度有點落後，我會追上。
詰まってる（つまってる）：卡住：今ここで詰まってる。原因見てくれる？我卡在這裡了，可以幫我看原因嗎？
回ってない（まわってない）：運作不良：体制が回ってないから、まず立て直そう。整個體制沒在運作，先把它拉回正軌。
ひとまず落ち着いた（ひとまずおちついた）：暫時穩下來：ひとまず落ち着いたから、次の手を考えよう。暫時穩下來了，來想下一步。
立て直す（たてなおす）：拉回正軌：ここから立て直せば、まだ間に合う。從這裡拉回正軌的話，還來得及。
}


`.trim();
    // ---------------------------------

    function escapeHTML(str) {
      return String(str ?? "")
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#39;");
    }

    function parseDataset(raw) {
      const lines = raw.split('\n').map(l => l.trim()).filter(l => l);
      const title = lines[0] || "Japanese Cards";
      const flat = [];
      const structure = {}; 

      let currentMain = null;
      let currentSub = null;

      lines.slice(1).forEach(line => {
        if (line.endsWith('{')) {
          const name = line.replace('{', '').trim();
          if (!currentMain) {
            currentMain = name;
            structure[currentMain] = [];
          } else {
            currentSub = name;
            if (!structure[currentMain].includes(currentSub)) structure[currentMain].push(currentSub);
          }
        } else if (line === '}') {
          if (currentSub) currentSub = null;
          else currentMain = null;
        } else if (line.includes('：')) {
          const p = line.split('：');
          // Extract reading in parentheses like 「目を通す（めをとおす）」
          const termRaw = p[0].trim();
          let term = termRaw;
          let reading = null;
          const tm = termRaw.match(/^(.+?)（(.+?)）$/);
          if (tm) {
            term = tm[1].trim();
            reading = tm[2].trim();
          }

          flat.push({
            mainCat: currentMain,
            subCat: currentSub || currentMain,
            term,
            reading,
            termRaw,
            meaning: (p[1] || "").trim(),
            example: p.slice(2).join('：').trim() || null
          });
        }
      });
      return { title, flat, structure };
    }

    const ds = parseDataset(RAW_DATA);
    const state = { q: "", cat: "ALL", type: "ALL" };
    const els = {
      title: document.getElementById("pageTitle"),
      q: document.getElementById("q"),
      cat: document.getElementById("cat"),
      type: document.getElementById("type"),
      grid: document.getElementById("grid"),
      chips: document.getElementById("chips"),
      empty: document.getElementById("empty")
    };

    function init() {
      els.title.textContent = ds.title;
      buildSelect(els.cat, Object.keys(ds.structure), "所有大類");
      updateTypeSelect();
      render();
    }

    function buildSelect(el, opts, allLabel) {
      el.innerHTML = `<option value="ALL">${allLabel}</option>`;
      opts.forEach(o => {
        const opt = document.createElement("option");
        opt.value = opt.textContent = o;
        el.appendChild(opt);
      });
    }

    function updateTypeSelect() {
      if (state.cat === "ALL") {
        els.type.innerHTML = `<option value="ALL">全部型態</option>`;
        els.type.disabled = true;
      } else {
        const subs = ds.structure[state.cat] || [];
        buildSelect(els.type, subs, "全部型態");
        els.type.disabled = subs.length === 0;
      }
      state.type = "ALL";
    }

    function render() {
      const filtered = ds.flat.filter(item => {
        if (state.cat !== "ALL" && item.mainCat !== state.cat) return false;
        if (state.type !== "ALL" && item.subCat !== state.type) return false;
        if (state.q) {
          const s = `${item.termRaw || item.term} ${item.reading || ''} ${item.meaning} ${item.example || ''}`.toLowerCase();
          if (!state.q.toLowerCase().split(' ').every(k => s.includes(k))) return false;
        }
        return true;
      });

      els.grid.innerHTML = filtered.map(item => `
        <article class="card">
          <div class="cardHead">
            <h2 class="term">${escapeHTML(item.term)}${item.reading ? '<span class="reading">（' + escapeHTML(item.reading) + '）</span>' : ''}</h2>
            <div class="tags">
              <span class="tag">${item.mainCat}</span>
              ${item.subCat !== item.mainCat ? `<span class="tag">${item.subCat}</span>` : ''}
            </div>
          </div>
          <div class="sec">
            <h3 class="secTitle">涵義</h3>
            <p class="meaning">${escapeHTML(item.meaning)}</p>
          </div>
          <div class="sec">
            <h3 class="secTitle">用法</h3>
            ${item.example ? `<p class="example">${escapeHTML(item.example)}</p>` : `<div class="muted-text">（暫無例句）</div>`}
          </div>
        </article>
      `).join('');

      els.empty.style.display = filtered.length ? "none" : "block";
      renderChips(filtered.length);
    }

    function renderChips(count) {
      els.chips.innerHTML = `
        <div class="chip">顯示 <strong>${count}</strong></div>
        <div class="chip">大類: <strong>${state.cat}</strong></div>
        ${state.type !== "ALL" ? `<div class="chip">型態: <strong>${state.type}</strong></div>` : ""}
      `;
    }

    els.q.addEventListener("input", e => { state.q = e.target.value; render(); });
    els.cat.addEventListener("change", e => { state.cat = e.target.value; updateTypeSelect(); render(); });
    els.type.addEventListener("change", e => { state.type = e.target.value; render(); });

    init();
  </script>
</body>
</html>




